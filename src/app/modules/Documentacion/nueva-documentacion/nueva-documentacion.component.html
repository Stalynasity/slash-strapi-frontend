<section class="card p-6 rounded-xl shadow-md space-y-4">
  <form [formGroup]="formulario" class="grid grid-cols-1 md:grid-cols-3 gap-4">
    <!-- Fila superior -->
    <div class="flex flex-col">
      <label class="mb-1 font-medium">Causa ra√≠z:</label>
      <input pInputText formControlName="causaRaiz" class="w-full" />
    </div>

    <div class="flex flex-col">
      <label class="mb-1 font-medium">Impacto:</label>
      <p-select [options]="opcionesImpacto" formControlName="impacto" optionLabel="label" placeholder="Seleccione" class="w-full" />
    </div>

    <div class="flex flex-col">
      <label class="mb-1 font-medium">Versi√≥n afectada:</label>
      <input pInputText formControlName="version" class="w-full" />
    </div>

    <!-- Recomendaciones y Soluci√≥n a la izquierda -->
    <div class="md:col-span-2 grid grid-cols-1 gap-4">
      <div class="flex flex-col">
        <label class="mb-1 font-medium">Recomendaciones</label>
        <textarea pTextarea formControlName="recomendaciones" rows="3" class="w-full"></textarea>
      </div>

      <div class="flex flex-col">
        <label class="mb-1 font-medium">Soluci√≥n aplicada:</label>
        <textarea pTextarea formControlName="solucion" rows="4" class="w-full"></textarea>
      </div>
    </div>

    <!-- Archivos adjuntos a la derecha -->
    <div class="flex flex-col h-full">
      <label class="mb-1 font-medium">Archivo Adjunto</label>
      <div class="max-h-[400px] overflow-y-auto border rounded-md p-2">
        <p-fileupload
          name="archivo[]"
          (onUpload)="onUpload($event)"
          [multiple]="true"
          accept="image/*"
          maxFileSize="500000"
          mode="advanced"
          url="https://www.primefaces.org/cdn/api/upload.php"
          chooseLabel="Elegir"
          uploadLabel="Subir"
          cancelLabel="Cancelar"
        >
          <ng-template #empty>
            <div>Arrastra y suelta los archivos aqu√≠ para subirlos.</div>
          </ng-template>
          <ng-template #content>
            <ul *ngIf="uploadedFiles.length" class="space-y-2">
              <li *ngFor="let file of uploadedFiles" class="text-sm">
                {{ file.name }} - {{ file.size / 1024 | number: '1.0-2' }} KB
              </li>
            </ul>
          </ng-template>
        </p-fileupload>
      </div>
    </div>
  </form>

  <!-- Botones -->
  <div class="flex justify-end gap-3">
    <p-button label="Borrar" severity="secondary" icon="pi pi-times" (click)="formulario.reset()" />
    <p-button label="Agregar" icon="pi pi-check" (click)="mostrarResumen()" />
  </div>

  <p-dialog header="Resumen de creaci√≥n" [(visible)]="mostrarDialogo" [modal]="true" [style]="{ width: '500px' }">
  <div class="space-y-3">
    <div>
      <p class="font-semibold text-gray-700"> <strong>Causa ra√≠za:</strong></p>
      <p class="text-sm text-gray-800 ml-2">{{ formulario.value.causaRaiz }}</p>
    </div>

    <div>
      <p class="font-semibold text-gray-700"> <strong>Impacto:</strong></p>
      <p class="text-sm text-gray-800 ml-2">{{ formulario.value.impacto?.label }}</p>
    </div>

    <div>
      <p class="font-semibold text-gray-700">üõ†Ô∏è <strong>Versi√≥n afectada:</strong></p>
      <p class="text-sm text-gray-800 ml-2">{{ formulario.value.version }}</p>
    </div>

    <div>
      <p class="font-semibold text-gray-700">üí° <strong>Recomendaciones:</strong></p>
      <p class="text-sm text-gray-800 ml-2 whitespace-pre-wrap">{{ formulario.value.recomendaciones }}</p>
    </div>

    <div>
      <p class="font-semibold text-gray-700">‚úÖ <strong>Soluci√≥n aplicada:</strong></p>
      <p class="text-sm text-gray-800 ml-2 whitespace-pre-wrap">{{ formulario.value.solucion }}</p>
    </div>

    <div>
      <p class="font-semibold text-gray-700">üìé <strong>Archivos adjuntos:</strong></p>
      <ul class="list-disc list-inside ml-2 text-sm text-gray-800">
        <li *ngFor="let archivo of uploadedFiles">
          {{ archivo.name }} ({{ archivo.size / 1024 | number: '1.0-0' }} KB)
        </li>
      </ul>
    </div>
  </div>

  <div class="flex justify-end gap-3 mt-5">
    <p-button label="Cancelar" icon="pi pi-times" (click)="mostrarDialogo = false" severity="secondary" />
    <p-button label="Confirmar" icon="pi pi-check" (click)="agregarSolucion()" />
  </div>
</p-dialog>

</section>
